{% extends "base_easydvf.html" %}
{% load staticfiles %}

{% block contenu %}

<div id="recherche">
    <table id="tableSearchResults" class="table table-hover table-striped">
        <thead>
            <tr>
                <th>#</th>
                <th>Id Mutation</th>
                <th>Code Service</th>
                <th>Date de mutation</th>
                <th>Valeur Foncière (€)</th>
                <th>Surface batie (m2)</th>
                <th>Surface terrain (m2)</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
        {% for mutation in mutations %}
            <tr id="{{mutation.id}}" class="accordion-toggle mutation" data-toggle="collapse" data-parent="#recherche" data-target=".detail_{{mutation.id}}">
                <td>{{forloop.counter}}</td>
                <td>{{mutation.id}}</td>
                <td>{{mutation.idmutinvar}}</td>
                <td>{{mutation.datemut}}</td>
                <td>{{mutation.valeurfonc}}</td>
                <td>{{mutation.sbati}}</td>
                <td>{{mutation.sterr}}</td>
                <td><i class="indicator glyphicon glyphicon-chevron-down pull-right"></i>
                </td>
            </tr>
            <tr>
                <td colspan="8" class="hiddenRow">
                    <div class="accordion-body collapse detail_{{mutation.id}}" id="accordion2">
                         
                    </div>
                </td>
            </tr>
        {% endfor %}
            <tr></tr>
        </tbody>
    </table>
</div>

<script type="text/javascript">
$('.mutation').on("click", function() {
  var identifiant = this.id;
  $.getJSON('/recherche/detail/' + this.id, function(data) {
       $('.detail_' + identifiant).html('<table class="table table-bordered table-condensed"><thead><tr><th>Mutation ' + identifiant + '</th><th></th></tr></thead><tbody><tr><td>Nombre de pièces</td><td>test</td></tr><tr><td>Valeur foncière</td><td>test</td></tr></tbody></table>');
  });
});
</script>
{% endblock %}
