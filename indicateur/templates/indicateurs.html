{% extends "base_indicateur.html" %}
{% load staticfiles %}

{% block contenu %}
<nav class="navbar navbar-default">
    <div class="container-fluid">

        <div class = "row">
            <div class = "col-sm-2">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"></button>
                    <a class="navbar-brand" href="#"><i class="fa fa-circle-o-notch fa-lg"></i> DÃ©partement</a>
                </div>
	        </div>
            <div class = "col-sm-8">
	            <form role="Departement" method="post">
                    {% csrf_token %} 
                    <div class="form-group">
                         <div class = "col-sm-10">
                        <select class="form-control selecteur" name='departement' onChange="submit()">
                            {% for departement in departements %}
                            <option value="{{ departement.pk }}" {% if request.session.departement == departement.pk %}selected{% endif %}>{{ departement }}</option>
                            {% endfor %}
			            </select> 
                        </div>
                          <div class = "col-sm-2">
		                      <button type="submit" class="btn btn-default" name="voir_departement">Voir</button>
                          </div>
                    </div>
                </form>
            </div>
            <div class ="col-sm-2">
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Charger <span class="caret"></span></a>
                        <ul class="dropdown-menu">
			                <li><a href="/creation_territoire">Nouveau territoire...</a></li>
			                <li role="separator" class="divider"></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
        <div class = "row">
            <div class = "col-sm-2">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"></button>
                    <a class="navbar-brand" href="#"><i class="fa fa-map-signs fa-lg"></i> Epci</a>
                </div>
	        </div>
            <div class = "col-sm-10">
	            <form class="navbar-form navbar-left" role="EPCI"  method="post">
                    {% csrf_token %} 
                    <div class="form-group">
                        <select class="form-control selecteur" name='epci'>
                            {% for epci in epcis %}
                            <option value="{{ epci.pk }}" {% if request.session.epci == epci.pk %}selected{% endif %}>{{ epci }}</option>
                            {% endfor %}
			            </select>
                        <button type="submit" class="btn btn-default" name="voir_epci">Voir</button>
                    </div>
                </form>
	        </div>
        </div>
        <div class = "row">
            <div class = "col-sm-2">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"></button>
                    <a class="navbar-brand" href="#"><i class="fa fa-building-o fa-lg"></i> Commune</a>
                </div>
	        </div>
            <div class = "col-sm-10">

                <form class="navbar-form navbar-left" role="Commune" method="post">
                    {% csrf_token %}           
                    <div class="form-group">
                        <select class="form-control selecteur" name='commune'>
                            {% for commune in communes %}
                            <option value="{{ commune.pk }}" {% if request.session.commune == commune.pk %}selected{% endif %}>{{ commune }}</option>
                            {% endfor %}
			            </select>
                    </div>
                    <button type="submit" class="btn btn-default" name="voir_commune">Voir</button>
                </form>
	            
            </div><!-- /.navbar-collapse -->
        </div>     
    </div>

</div><!-- /.container-fluid -->
</nav>

<div class = "container">

{% for i in indicateursDVF %}
    <div class="panel panel-default">

        <div class="panel-heading">
	        <h3 class="panel-title"><i class="fa fa-bar-chart-o"></i> {{i.nom}}</h3>
        </div>
        <div class="panel-body">
            <div class = "col-sm-offset-3 col-sm-6 col-sm-offset-3">
                <figure style="width: 480px; height: 250px;" id="{{i.idgraph}}"></figure>
            </div>
        </div>
    </div>
		  <script>
	   	  var data = {{i.graph|safe}};
    	  var chart = new xChart('{{i.type_graph}}', data, '#{{i.idgraph}}');
		  </script>
{% endfor %}
</div>

<script type="text/javascript">
$(document).ready(function() {
  $(".selecteur").select2();
});
</script>

{% endblock %}
